# 分享一个记工时的程序

## 记工时

最近这家公司是弹性打卡的，早上八点到九点是弹性上班时间，就算每天没有上足8小时，傍晚五点半可以提前走，但要求平均每周40小时，即每月每天8小时。

能早点下班，我肯定早点走的，但是早下班的次数多，心跟着慌起来。因为怕工时不够，公司扣钱。肯定不想给它多加班。因为在上一家公司时，有4，5个月加班时间很多，累的要命，时间又不能算钱，最后调休部分，其他全清空。经一事长一智，不能再吃这样的亏。

加班是什么？加班是老板请少几个人，把多出来的工作量分给受雇的那些人，同时设立年奖金，优秀员工称号等鼓励激发员工多加班多努力，从而降低成本，挣更多的钱，实现自己开公司买车买房等等一系列奇奇怪怪的理想。天下熙熙，皆为利来。说的就是这个道理。每个人都为自己的利益最大化努力，是再正常不过的。员工加班对于老板来是好事。公司运作的本质是盈利，能帮忙挣钱【效率高】的人迎进门，不能干活的请出去。任何人都是这样。

其实你是什么样的一个人，优秀与否，品质如何，不是父母或者老板口中评论，不是他人一面之词，你自己应该有自己的标准，保持高度的自我完整性，尊重自己，不要活在别人的评论中。

但加班太多对员工来说，便不是好事。员工需要牺牲自己的个人时间，自己的身体健康，去换取所谓的企业认可，老板的赞同，是否值得。其实没有必要，加班好比借钱，救急不救贫。

所以为了清楚的看到每个月多加出来的时间【按分钟算】，控制一下加班时间，避免多加班，我写了如下代码。

使用方法是：在公司的网页版考勤系统的找到考勤详情页面，按F12,拿到后台返回来的考勤数组，赋值给`daysArray`【若没有网页版的，每月下旬开始自己看钉钉记录拼接数据，十分钟的事】；按自己公司的考勤计算规则，稍做修改；放在浏览器或者`nodejs`运行，不会运行的可以百度或者找程序员朋友帮忙。学会使用便行。

```javascript
    //统计每个月的加班时间分钟数
    //避免多加班
    let daysArray = [];
    //换算时间
    function timeStringToMinutes(string){
        //string值 例如 18：00
        let hour = Number(string.split(":")[0]);
        let minutes = Number(string.split(":")[1]);
        return hour * 60 + minutes;
    }
    //关键逻辑是把上班日的每天加班的分钟数相加就行。
    let minutes = daysArray.reduce((totalMinutes, day) => {
        let minuteValue1 = timeStringToMinutes('17:30');
        let minuteValue2 = timeStringToMinutes('18:00');
        let startTime, endTime;
        if(day.startTime !== day.endTime && day.startTime.includes('Oct') && !day.startTime.includes('Oct 24')){
            //上班了&&当前月&&排除月内加班日
            //开始计算多出来的时间
            startTime = timeStringToMinutes(day.startTime);
            endTime = timeStringToMinutes(day.end);
            if(endTime < minuteValue2){
            //如果18：00之前下班，算17：30；
                endTime = minuteValue1;
            }else {
                //17:30~18:00 不能算在内
                endTime -= 30;
            }
            //中午休息时间是90分钟，一天需要上八小时班
            totalMinutes  += (endTime - startTime - 90 - 60 * 8) 
        }
        return totalMinutes;
    },0)
    console.log(minutes);
```

## 流语句的优化写法

最近参加过公司的一次代码评审，同事指出我的一个问题：写流语句是判断很多，嵌套多，阅读理解费劲。

其实这种可以使用`if xxx return`优化，减少嵌套的层数，化并行为串行。就好像上面的记工时代码，if里面的写法可以这样优化。

把`if`里面的三个条件拆分写：不满足的就return，不往下走【执行】；不要搞改太多的 条件1 && 条件2 && 条件 3...或者 条件1 || 条件2 || 条件3... 迟早搞死自己。写到这里，突然明白了，为啥之前写类似的功能会很慢，因为条件多，多层嵌套，不容易阅读理解。

下面的代码就是走一条路，满足一个条件，往前走一公里，谁牛逼谁走到最后；上面那个代码走到if那里便是2条或者多条路了，复杂一些的页面路里面还有分叉路，给人感觉怎么走都是不对的，流汗。

```javascript
//统计每个月的加班时间分钟数
//避免多加班
let daysArray = [];
function timeStringToMinutes(string){
    //string值 例如 18：00
    let hour = Number(string.split(":")[0]);
    let minutes = Number(string.split(":")[1]);
    return hour * 60 + minutes;
}
//关键逻辑是把上班日的每天加班的分钟数相加就行。
let minutes = daysArray.reduce((totalMinutes, day) => {
    let minuteValue1 = timeStringToMinutes('17:30');
    let minuteValue2 = timeStringToMinutes('18:00');
    let startTime, endTime;
    if(day.startTime === day.endTime){
        //排除尚未更新日
        return totalMinutes;
    }
    if(!day.startTime.includes(nowMonth)){
        //排除非本月的工作日
        return totalMinutes;
    }
    if(day.startTime.includes(nowMonth + ' 24')){
        //排除非工作日的加班日
        return totalMinutes;
    }
    //开始计算时间【按分钟】
    startTime = timeStringToMinutes(day.startTime);
    endTime = timeStringToMinutes(day.end);
    if(endTime < minuteValue2){
    //如果18：00之前下班，算17：30；
        endTime = minuteValue1;
    }else {
        //17:30~18:00 不能算在内
        endTime -= 30;
    }
    //中午休息时间是90分钟，一天需要上八小时班
    totalMinutes  += (endTime - startTime - 90 - 60 * 8) 
    return totalMinutes;
},0)
console.log(minutes);
```


## 前端调试【其他环境数据】

最近发生了一件打我脸的事情：

在一次紧急的关头，有个问题，我处理不了，最后还是同事帮忙处理的。我的能力应该不算强的。

#### try catch

#### window.onerror

#### vscode调试

#### 浏览器调试
